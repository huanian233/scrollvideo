(this.webpackJsonpscrollvideo=this.webpackJsonpscrollvideo||[]).push([[0],{18:function(e,n,t){},20:function(e,n,t){},23:function(e,n,t){"use strict";t.r(n);var i=t(9),a=t.n(i),r=t(12),o=t.n(r),s=(t(18),t(0)),c=t(1),v=t(2),l=t(3),u=t(7),d=t.p+"static/media/4Kjd1.881c2cd5.mp4",m=t.p+"static/media/4K\u5b87\u5b991.30130b14.mp4",h=t.p+"static/media/4K\u5b87\u5b992.f91cb95f.mp4",_=function(){function e(n){var t=this;Object(s.a)(this,e),this._render=void 0,this._sence=void 0,this._camera=void 0,this._plane=void 0,this._material=void 0,this._time=0,this._speed=0,this._position=9,this._videos=void 0,this._loader=new u.h,this.onResize=function(){var e=window.innerWidth,n=window.innerHeight;if(t._render&&t._render.setSize(e,n),t._camera){t._camera.aspect=e/n;var i=t._camera.position.z-t._plane.position.z;t._camera.fov=180/Math.PI*2*Math.atan(1/(2*i))}t._material&&(t._material.uniforms.uvRate1.value.y=n/e),t._plane&&(t._plane.scale.x=e/n),t._camera&&t._camera.updateProjectionMatrix()},this.onWheel=function(e){t._speed+=2e-4*e.deltaY},this.raf=function(){t._position+=t._speed,t._speed*=.7;var e=Math.round(t._position),n=e-t._position;t._position+=.035*n,Math.abs(e-t._position)<.001&&(t._position=e),t._material.uniforms.progress.value=t._position;var i=(Math.floor(t._position)-1+t._videos.length)%t._videos.length,a=((Math.floor(t._position)+1)%t._videos.length-1+t._videos.length)%t._videos.length;console.log(i,a),t._material.uniforms.texture1.value=t._videos[i],t._material.uniforms.texture2.value=t._videos[a],window.requestAnimationFrame(t.raf)};var i=document.getElementById(n);this._sence=new u.f,this._render=new u.k({canvas:i}),this._render.setPixelRatio(window.devicePixelRatio),this._render.setSize(window.innerWidth,window.innerHeight),this._camera=new u.d(70,window.innerWidth/window.innerHeight,.001,100),this._camera.position.set(0,0,1),this._videos=[p(d),p(m),p(h)]}return Object(c.a)(e,[{key:"CreateScence",value:function(){this._material=new u.g({side:u.a,uniforms:{time:{type:"f",value:this._time},pixels:{type:"v2",value:new u.i(window.innerWidth,window.innerHeight)},accel:{type:"v2",value:new u.i(.5,2)},progress:{type:"f",value:0},uvRate1:{value:new u.i(1,1)},texture1:{value:this._videos[0]},texture2:{value:this._videos[1]}},vertexShader:"\nuniform float time;\nvarying vec2 vUv;\nvarying vec2 vUv1;\nvarying vec4 vPosition;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform vec2 pixels;\nuniform vec2 uvRate1;\n\nvoid main() {\n  vUv = uv;\n  vec2 _uv = uv - 0.5;\n  vUv1 = _uv;\n  vUv1 *= uvRate1.xy;\n\n  vUv1 += 0.5;\n\n\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform float time;\nuniform float progress;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform vec2 pixels;\nuniform vec2 uvRate1;\nuniform vec2 accel;\n\nvarying vec2 vUv;\nvarying vec2 vUv1;\nvarying vec4 vPosition;\n\n\nvec2 mirrored(vec2 v) {\n\tvec2 m = mod(v,2.);\n\treturn mix(m,2.0 - m, step(1.0 ,m));\n}\n\nfloat tri(float p) {\n\treturn mix(p,1.0 - p, step(0.5 ,p))*2.;\n}\n\n\nvoid main()\t{\n\tvec2 uv = gl_FragCoord.xy/pixels.xy;\n\t\n\tfloat p = fract(progress);\n\n\tfloat delayValue = p*7. - uv.y*2. + uv.x - 2.;\n\n\tdelayValue = clamp(delayValue,0.,1.);\n\n\tvec2 translateValue = p + delayValue*accel;\n\tvec2 translateValue1 = vec2(-0.5,1.)* translateValue;\n\tvec2 translateValue2 = vec2(-0.5,1.)* (translateValue - 1. - accel);\n\n\tvec2 w = sin( sin(time)*vec2(0,0.3) + vUv.yx*vec2(0,4.))*vec2(0,0.5);\n\tvec2 xy = w*(tri(p)*0.5 + tri(delayValue)*0.5);\n\n\tvec2 uv1 = vUv1 + translateValue1 + xy;\n\tvec2 uv2 = vUv1 + translateValue2 + xy;\n\n\tvec4 rgba1 = texture2D(texture1,mirrored(uv1));\n\tvec4 rgba2 = texture2D(texture2,mirrored(uv2));\n\n\tvec4 rgba = mix(rgba1,rgba2,delayValue);\n\tgl_FragColor = rgba;\n\t// gl_FragColor = vec4(tri(progress));\n\t// gl_FragColor = vec4(delayValue);\n\t// gl_FragColor = vec4(delayValue);\n//\t gl_FragColor = vec4(uv,1.,1.);\n}"}),this._plane=new u.c(new u.e(1,1,1,1),this._material),this._sence.add(this._plane),this.onResize()}},{key:"render",value:function(){var e=this;!function n(){e._time=e._time+.05,e._material.uniforms.time.value=e._time,requestAnimationFrame(n),e._render.render(e._sence,e._camera)}()}}]),e}();function p(e){var n=document.createElement("video");n.muted=!0,n.loop=!0,n.autoplay=!0,n.src=e;var t=new u.j(n);t.minFilter=u.b,t.magFilter=u.b,n.load();var i=n.play();return i&&i.catch((function(){})),t}t(20);var f=t(8),g=function(e){Object(v.a)(t,e);var n=Object(l.a)(t);function t(e){var i;return Object(s.a)(this,t),(i=n.call(this,e))._scence=void 0,i._canvasid="renderCanvas",i}return Object(c.a)(t,[{key:"componentDidMount",value:function(){this._scence=new _(this._canvasid),this._scence.CreateScence(),window.addEventListener("resize",this._scence.onResize),this._scence.render(),window.addEventListener("wheel",this._scence.onWheel),this._scence.raf()}},{key:"render",value:function(){var e=this._canvasid;return Object(f.jsx)("canvas",{id:e})}}]),t}(a.a.Component),x=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,24)).then((function(n){var t=n.getCLS,i=n.getFID,a=n.getFCP,r=n.getLCP,o=n.getTTFB;t(e),i(e),a(e),r(e),o(e)}))},y=t(13),w=t.n(y),b=function(e){Object(v.a)(t,e);var n=Object(l.a)(t);function t(){return Object(s.a)(this,t),n.apply(this,arguments)}return Object(c.a)(t,[{key:"render",value:function(){return Object(f.jsxs)("div",{style:{height:"100vh"},children:[Object(f.jsxs)("div",{style:{position:"absolute",zIndex:1,top:0,left:0,right:0,bottom:0,padding:"1em",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"#fff",fontFamily:'Quicksand, "Helvetica Neue", sans-serif',pointerEvents:"none"},children:[Object(f.jsx)("h1",{style:{fontSize:"3em",textShadow:"2px 2px 8px rgba(0, 0, 0, 0.5)"},children:"Scroll Video"}),Object(f.jsx)("p",{style:{fontSize:"1.5em"},children:"\u6ed1\u52a8\u9f20\u6807\u6eda\u8f6e"})]}),Object(f.jsx)(w.a,{href:"https://github.com/transitive-bullshit/react-fluid-gallery",bannerColor:"#70B7FD"})]})}}]),t}(i.Component);o.a.render(Object(f.jsxs)(a.a.StrictMode,{children:[Object(f.jsx)(g,{}),Object(f.jsx)(b,{})]}),document.getElementById("root")),x()}},[[23,1,2]]]);
//# sourceMappingURL=main.fdc886e2.chunk.js.map